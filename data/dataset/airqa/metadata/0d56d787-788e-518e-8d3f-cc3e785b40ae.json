{
    "uuid": "0d56d787-788e-518e-8d3f-cc3e785b40ae",
    "title": "PyramidInfer: Pyramid KV Cache Compression for High-throughput LLM Inference",
    "conference_full": "Annual Meeting of the Association for Computational Linguistics",
    "conference": "ACL",
    "year": 2024,
    "volume": "Findings of the Association for Computational Linguistics: ACL 2024",
    "bibtex": "@inproceedings{yang-etal-2024-pyramidinfer,\n    title = \"{P}yramid{I}nfer: Pyramid {KV} Cache Compression for High-throughput {LLM} Inference\",\n    author = \"Yang, Dongjie  and\n      Han, Xiaodong  and\n      Gao, Yan  and\n      Hu, Yao  and\n      Zhang, Shilin  and\n      Zhao, Hai\",\n    editor = \"Ku, Lun-Wei  and\n      Martins, Andre  and\n      Srikumar, Vivek\",\n    booktitle = \"Findings of the Association for Computational Linguistics: ACL 2024\",\n    month = aug,\n    year = \"2024\",\n    address = \"Bangkok, Thailand\",\n    publisher = \"Association for Computational Linguistics\",\n    url = \"https://aclanthology.org/2024.findings-acl.195\",\n    doi = \"10.18653/v1/2024.findings-acl.195\",\n    pages = \"3258--3270\",\n    abstract = \"Large Language Models (LLMs) have shown remarkable comprehension abilities but face challenges in GPU memory usage during inference, hindering their scalability for real-time applications like chatbots. To accelerate inference, we store computed keys and values (KV cache) in the GPU memory. Existing methods study the KV cache compression to reduce memory by pruning the pre-computed KV cache. However, they neglect the inter-layer dependency between layers and huge memory consumption in pre-computation. To explore these deficiencies, we find that the number of crucial keys and values that influence future generations decreases layer by layer and we can extract them by the consistency in attention weights. Based on the findings, we propose PyramidInfer, a method that compresses the KV cache by layer-wise retaining crucial context. PyramidInfer saves significant memory by computing fewer keys and values without sacrificing performance. Experimental results show PyramidInfer improves 2.2x throughput compared to Accelerate with over 54{\\%} GPU memory reduction in KV cache.\",\n}\n",
    "authors": [
        "Dongjie Yang",
        "Xiaodong Han",
        "Yan Gao",
        "Yao Hu",
        "Shilin Zhang",
        "Hai Zhao"
    ],
    "pdf_url": "https://aclanthology.org/2024.findings-acl.195.pdf",
    "pdf_path": "data/dataset/airqa/papers/acl2024/0d56d787-788e-518e-8d3f-cc3e785b40ae.pdf",
    "abstract": "Large Language Models (LLMs) have shown remarkable comprehension abilities but face challenges in GPU memory usage during inference, hindering their scalability for real-time applications like chatbots. To accelerate inference, we store computed keys and values (KV cache) in the GPU memory. Existing methods study the KV cache compression to reduce memory by pruning the pre-computed KV cache. However, they neglect the inter-layer dependency between layers and huge memory consumption in pre-computation. To explore these deficiencies, we find that the number of crucial keys and values that influence future generations decreases layer by layer and we can extract them by the consistency in attention weights. Based on the findings, we propose PyramidInfer, a method that compresses the KV cache by layer-wise retaining crucial context. PyramidInfer saves significant memory by computing fewer keys and values without sacrificing performance. Experimental results show PyramidInfer improves 2.2x throughput compared to Accelerate with over 54% GPU memory reduction in KV cache.",
    "num_pages": 13
}