{
    "uuid": "746ec934-d96f-5ea3-8a0f-6092dd0f3fae",
    "title": "CoCA: Fusing Position Embedding with Collinear Constrained Attention in Transformers for Long Context Window Extending",
    "conference_full": "Annual Meeting of the Association for Computational Linguistics",
    "conference": "ACL",
    "year": 2024,
    "volume": "Proceedings of the 62nd Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)",
    "bibtex": "@inproceedings{zhu-etal-2024-coca,\n    title = \"{C}o{CA}: Fusing Position Embedding with Collinear Constrained Attention in Transformers for Long Context Window Extending\",\n    author = \"Zhu, Shiyi  and\n      Ye, Jing  and\n      Jiang, Wei  and\n      Xue, Siqiao  and\n      Zhang, Qi  and\n      Wu, Yifan  and\n      Li, Jianguo\",\n    editor = \"Ku, Lun-Wei  and\n      Martins, Andre  and\n      Srikumar, Vivek\",\n    booktitle = \"Proceedings of the 62nd Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)\",\n    month = aug,\n    year = \"2024\",\n    address = \"Bangkok, Thailand\",\n    publisher = \"Association for Computational Linguistics\",\n    url = \"https://aclanthology.org/2024.acl-long.233\",\n    doi = \"10.18653/v1/2024.acl-long.233\",\n    pages = \"4247--4262\",\n    abstract = \"Self-attention and position embedding are two crucial modules in transformer-based Large Language Models (LLMs). However, the potential relationship between them is far from well studied, especially for long context window extending. In fact, anomalous behaviors that hinder long context extrapolation exist between Rotary Position Embedding (RoPE) and vanilla self-attention.Incorrect initial angles between $Q$ and $K$ can cause misestimation in modeling rotary position embedding of the closest tokens.To address this issue, we propose $\\textbf{Co}$llinear $\\textbf{C}$onstrained $\\textbf{A}$ttention mechanism, namely CoCA. Specifically, we enforce a collinear constraint between $Q$ and $K$ to seamlessly integrate RoPE and self-attention.While only adding minimal computational and spatial complexity, this integration significantly enhances long context window extrapolation ability. We provide an optimized implementation, making it a drop-in replacement for any existing transformer-based models.Extensive experiments demonstrate that CoCA excels in extending context windows. A CoCA-based GPT model, trained with a context length of 512, can extend the context window up to 32K (60$\\times$) without any fine-tuning.Additionally, incorporating CoCA into LLaMA-7B achieves extrapolation up to 32K within a training length of only 2K.Our code is publicly available at: https://github.com/codefuse-ai/Collinear-Constrained-Attention\",\n}\n",
    "authors": [
        "Shiyi Zhu",
        "Jing Ye",
        "Wei Jiang",
        "Siqiao Xue",
        "Qi Zhang",
        "Yifan Wu",
        "Jianguo Li"
    ],
    "pdf_url": "https://aclanthology.org/2024.acl-long.233.pdf",
    "pdf_path": "data/dataset/airqa/papers/acl2024/746ec934-d96f-5ea3-8a0f-6092dd0f3fae.pdf",
    "abstract": "Self-attention and position embedding are two crucial modules in transformer-based Large Language Models (LLMs). However, the potential relationship between them is far from well studied, especially for long context window extending. In fact, anomalous behaviors that hinder long context extrapolation exist between Rotary Position Embedding (RoPE) and vanilla self-attention.Incorrect initial angles between Q and K can cause misestimation in modeling rotary position embedding of the closest tokens.To address this issue, we propose Collinear Constrained Attention mechanism, namely CoCA. Specifically, we enforce a collinear constraint between Q and K to seamlessly integrate RoPE and self-attention.While only adding minimal computational and spatial complexity, this integration significantly enhances long context window extrapolation ability. We provide an optimized implementation, making it a drop-in replacement for any existing transformer-based models.Extensive experiments demonstrate that CoCA excels in extending context windows. A CoCA-based GPT model, trained with a context length of 512, can extend the context window up to 32K (60Ã—) without any fine-tuning.Additionally, incorporating CoCA into LLaMA-7B achieves extrapolation up to 32K within a training length of only 2K.Our code is publicly available at: https://github.com/codefuse-ai/Collinear-Constrained-Attention",
    "num_pages": 16
}